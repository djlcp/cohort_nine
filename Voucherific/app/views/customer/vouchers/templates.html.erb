<!--This is the view for the new or logged in customer to get a new coupon -->

<div>
    <!-- Greeting to the signed in user. Note this needs fixing when devise is sorted -->
    <h1> Hi <%= current_user.email %>, here are today's deals avaliable to you! </h1> 
        <div>


            <% @templates.each do |template| %>

                    <div class="customertemplate">
                        <p><strong> <%= template.description %></strong></p>
                        <p>Value: Â£<%= template.value %>

                        <% if @voucher = Voucher.where(template_id: template.id, customer_id: current_user.id).first %>

                        <p> you already have this voucher <p>
 
                        
                        <% else %>

                        <p> <%= link_to "Get this coupon", {controller: 'vouchers', action: 'custom', id: template.id}, method: :post, class: "btn btn-primary"   %></p>

                        <% end %>
                    </div>

  
            <% end %>
        </div>  

     <p><%= link_to "Back", customer_vouchers_path, class: "btn btn-primary" %></p> 