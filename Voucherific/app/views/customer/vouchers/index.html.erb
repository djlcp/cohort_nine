<!--This is the view for all coupons for the logged in customer. It is the first page for any existing user when they log in-->

<div class="text-center">
    <!-- Greeting to the signed in user. Note this needs fixing when devise is sorted -->
     <h1> Hi <%= current_user.email %></h1> 


    <!-- takes user to the new  page which lists all the pre-made Coupons avaliable to the user for selection-->
  
    <h2> Here are all your vouchers </h2>
</div>
        <div>
        <% @vouchers.order("created_at DESC").each do |voucher| %>
            <div class="container">
            <div class="card-deck mb-3 text-center">
            <div class="card mb-4 shadow-sm">
            <div class="card-header">
                    <p><strong> <%= voucher.template.description %></strong></p>
                    </div>
            <div class="card-body">
                        <p>Voucher number: <%= voucher.number %>
                        <p>Value: Â£<%= voucher.template.value %>
                        <p>Created at: <%= voucher.created_at.to_formatted_s(:short) %>
                        <p> Status: <%= voucher.status %>
                        <p> <%= link_to "Send to email", :controller => "customer/vouchers", :action => "email_notice", :user => @current_user_email, :voucher_number => voucher.number, class: "btn btn-primary" %></p>
                </div>
            </div>
        <% end %>
        </div>
        
        <!-- ADD IN A MAGICAL NOTICE -->
        <!-- takes user back to the previous page they were on -->
        <p><%= link_to "Back to Homepage", root_path, class: "btn btn-primary" %></p> 
</div>
